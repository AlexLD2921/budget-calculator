<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>UK Pay & Budget Dashboard | apeX CX</title>
<script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
<script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<style>
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;background:#f8fafc;color:#1f2937}
input,select,button{font-family:inherit}
button{cursor:pointer}
button:disabled{cursor:not-allowed;opacity:0.5}
.container{max-width:900px;margin:0 auto;padding:24px 16px}
.card{background:#fff;border:1px solid #e5e7eb;border-radius:12px;padding:20px;margin-bottom:16px}
.btn{padding:10px 16px;border-radius:8px;font-size:14px;font-weight:600;border:none;transition:all 0.15s}
.btn-primary{background:#6366f1;color:#fff}
.btn-primary:hover{background:#4f46e5}
.stat{border-radius:12px;padding:16px;border:1px solid}
.stat-green{background:#f0fdf4;border-color:#86efac;color:#16a34a}
.stat-red{background:#fef2f2;border-color:#fca5a5;color:#dc2626}
.stat-blue{background:#eef2ff;border-color:#c7d2fe;color:#4f46e5}
.field{margin-bottom:12px}
.field label{display:block;font-size:11px;color:#6b7280;margin-bottom:4px;font-weight:500}
.field input,.field select{width:100%;padding:8px 10px;border:1px solid #d1d5db;border-radius:6px;font-size:14px}
.field input:focus,.field select:focus{outline:none;border-color:#6366f1;box-shadow:0 0 0 3px rgba(99,102,241,0.1)}
.grid{display:grid;gap:12px}
.grid-2{grid-template-columns:1fr 1fr}
.grid-3{grid-template-columns:1fr 1fr 1fr}
</style>
</head>
<body>
<div id="root"></div>
<script type="text/babel">
const {useState,useEffect,useMemo}=React;

const gbp=n=>new Intl.NumberFormat("en-GB",{style:"currency",currency:"GBP",maximumFractionDigits:0}).format(n||0);

const calcTax=g=>{if(g<=12570)return 0;const ti=g-12570;if(g<=50270)return ti*0.20;if(g<=125140)return(50270-12570)*0.20+(g-50270)*0.40;return(50270-12570)*0.20+(125140-50270)*0.40+(g-125140)*0.45};
const calcNI=g=>{if(g<=12570)return 0;if(g<=50270)return(g-12570)*0.08;return(50270-12570)*0.08+(g-50270)*0.02};
const SL={plan1:{t:24990,r:0.09},plan2:{t:27295,r:0.09},plan4:{t:31395,r:0.09},plan5:{t:25000,r:0.09},postgrad:{t:21000,r:0.06}};

function calcP(p){
const base=parseFloat(p.grossSalary)||0,bonus=parseFloat(p.bonus)||0;
const bens=(parseFloat(p.carBenefit)||0)+(parseFloat(p.medicalBenefit)||0)+(parseFloat(p.otherBenefits)||0);
const gross=base+bonus+bens;
let pen=base*(parseFloat(p.pensionPercent)||0)/100+(parseFloat(p.pensionFixed)||0);
let ePen=base*(parseFloat(p.employerPensionPercent)||0)/100+(parseFloat(p.employerPensionFixed)||0);
const cc=parseFloat(p.childcare)||0,cy=parseFloat(p.cyclescheme)||0;
const taxable=gross-pen-cc-cy;
const tax=calcTax(taxable),ni=calcNI(taxable);
let sl=0;
if(p.studentLoan&&p.studentLoan!=="none"&&SL[p.studentLoan]){const{t,r}=SL[p.studentLoan];if(gross>t)sl=(gross-t)*r}
const net=gross-tax-ni-pen-cc-cy-sl;
return{gross,base,bonus,bens,tax,ni,pen,ePen,totalPen:pen+ePen,sl,net,netM:net/12,netW:net/52}
}

const emptyP=()=>({grossSalary:"",bonus:"",carBenefit:"",medicalBenefit:"",otherBenefits:"",pensionPercent:"",pensionFixed:"",employerPensionPercent:"",employerPensionFixed:"",studentLoan:"none",childcare:"",cyclescheme:""});

const ls={get:k=>{try{return JSON.parse(localStorage.getItem(k))}catch(e){return null}},set:(k,v)=>{try{localStorage.setItem(k,JSON.stringify(v))}catch(e){}}};

function App(){
const[tab,setTab]=useState("calc");
const[incomes,setIncomes]=useState(()=>ls.get("apex_inc")||[]);
const[outgoings,setOutgoings]=useState(()=>ls.get("apex_out")||[]);
useEffect(()=>ls.set("apex_inc",incomes),[incomes]);
useEffect(()=>ls.set("apex_out",outgoings),[outgoings]);

const useInBudget=(p1,p2)=>{
const ni=[{id:Date.now(),name:"Salary (Person 1)",amount:Math.round(p1),category:"Salary",dateRule:"last"}];
if(p2)ni.push({id:Date.now()+1,name:"Salary (Person 2)",amount:Math.round(p2),category:"Salary",dateRule:"last"});
setIncomes(ni);setTab("budget");
};

return <div className="container">
<div style={{textAlign:"center",marginBottom:"24px"}}>
<h1 style={{fontSize:"28px",fontWeight:"700",margin:"0 0 4px"}}>UK Pay & Budget Dashboard</h1>
<p style={{color:"#9ca3af",fontSize:"13px"}}>Tax Year 2024/25 Â· apeX CX</p>
</div>

<div style={{display:"flex",background:"#fff",border:"1px solid #e5e7eb",borderRadius:"12px",padding:"4px",gap:"4px",marginBottom:"24px"}}>
{[["calc","ðŸ’° Pay Calculator"],["budget","ðŸ“‹ Budget Setup"],["dashboard","ðŸ“Š Dashboard"]].map(([id,lbl])=>
<button key={id} onClick={()=>setTab(id)} className="btn" style={{flex:1,background:tab===id?"#6366f1":"transparent",color:tab===id?"#fff":"#6b7280",border:"none"}}>{lbl}</button>
)}
</div>

{tab==="calc"&&<PayCalc onUse={useInBudget}/>}
{tab==="budget"&&<p style={{textAlign:"center",padding:"40px",color:"#9ca3af"}}>Budget wizard coming soon</p>}
{tab==="dashboard"&&<Dashboard incomes={incomes}/>}

<p style={{textAlign:"center",color:"#d1d5db",fontSize:"11px",marginTop:"32px"}}>apeX CX Â· apexcx.co.uk Â· 2024/25 tax rates</p>
</div>
}

function PayCalc({onUse}){
const[hm,setHm]=useState("single");
const[p1,setP1]=useState(emptyP());
const[p2,setP2]=useState(emptyP());

const r1=useMemo(()=>calcP(p1),[p1]);
const r2=useMemo(()=>hm==="dual"?calcP(p2):null,[p2,hm]);

return <div>
<div style={{display:"flex",justifyContent:"center",marginBottom:"20px"}}>
<div style={{display:"inline-flex",background:"#fff",border:"1px solid #e5e7eb",borderRadius:"10px",padding:"4px",gap:"4px"}}>
{[["single","ðŸ‘¤ Single Income"],["dual","ðŸ‘¥ Two Incomes"]].map(([v,l])=>
<button key={v} onClick={()=>setHm(v)} className="btn" style={{padding:"8px 16px",background:hm===v?"#6366f1":"transparent",color:hm===v?"#fff":"#6b7280",border:"none"}}>{l}</button>
)}
</div>
</div>

<div className="grid" style={{gridTemplateColumns:hm==="dual"?"1fr 1fr":"1fr"}}>
<PersonInput p={p1} setP={setP1} label={hm==="dual"?"Person 1":"Your Details"}/>
{hm==="dual"&&<PersonInput p={p2} setP={setP2} label="Person 2"/>}
</div>

<div className="grid" style={{gridTemplateColumns:hm==="dual"?"1fr 1fr":"1fr",marginTop:"16px"}}>
<PersonResult r={r1} label={hm==="dual"?"Person 1 Take-Home":"Your Take-Home"}/>
{hm==="dual"&&r2&&<PersonResult r={r2} label="Person 2 Take-Home"/>}
</div>

{hm==="dual"&&r2&&<div className="card" style={{background:"#f0fdf4",border:"1px solid #86efac"}}>
<div style={{display:"flex",justifyContent:"space-between",alignItems:"baseline",marginBottom:"10px"}}>
<span style={{fontWeight:"600"}}>Combined Household Take-Home</span>
<span style={{fontSize:"24px",fontWeight:"700",color:"#16a34a"}}>{gbp(r1.net+r2.net)}</span>
</div>
<div className="grid grid-2" style={{fontSize:"13px"}}>
<div><span style={{color:"#6b7280",fontSize:"11px"}}>Monthly</span><div style={{fontWeight:"600",color:"#16a34a"}}>{gbp(r1.netM+r2.netM)}</div></div>
<div><span style={{color:"#6b7280",fontSize:"11px"}}>Weekly</span><div style={{fontWeight:"600",color:"#16a34a"}}>{gbp(r1.netW+r2.netW)}</div></div>
</div>
</div>}

<button onClick={()=>onUse(r1.netM,hm==="dual"&&r2?r2.netM:null)} className="btn btn-primary" style={{width:"100%",marginTop:"16px",padding:"14px",fontSize:"15px"}}>
â†’ Use this income in my budget
</button>
</div>
}

const PersonInput=React.memo(({p,setP,label})=>{
const handleChange=(field)=>(e)=>{
setP(prev=>({...prev,[field]:e.target.value}));
};

return <div className="card">
<h3 style={{fontSize:"16px",fontWeight:"600",marginBottom:"16px"}}>{label}</h3>
<div className="field">
<label>Base Annual Salary</label>
<div style={{position:"relative"}}>
<span style={{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#9ca3af"}}>Â£</span>
<input type="number" value={p.grossSalary} onChange={handleChange('grossSalary')} placeholder="50000" style={{paddingLeft:"26px"}}/>
</div>
</div>
<div className="grid grid-2">
<div className="field">
<label>Annual Bonus</label>
<div style={{position:"relative"}}>
<span style={{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#9ca3af"}}>Â£</span>
<input type="number" value={p.bonus} onChange={handleChange('bonus')} placeholder="0" style={{paddingLeft:"26px"}}/>
</div>
</div>
<div className="field">
<label>Car Benefit</label>
<div style={{position:"relative"}}>
<span style={{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#9ca3af"}}>Â£</span>
<input type="number" value={p.carBenefit} onChange={handleChange('carBenefit')} placeholder="0" style={{paddingLeft:"26px"}}/>
</div>
</div>
<div className="field">
<label>Pension %</label>
<input type="number" value={p.pensionPercent} onChange={handleChange('pensionPercent')} placeholder="5"/>
</div>
<div className="field">
<label>Employer Pension %</label>
<input type="number" value={p.employerPensionPercent} onChange={handleChange('employerPensionPercent')} placeholder="3"/>
</div>
</div>
<div className="field">
<label>Student Loan</label>
<select value={p.studentLoan} onChange={handleChange('studentLoan')}>
<option value="none">None</option>
{Object.keys(SL).map(k=><option key={k} value={k}>{k.charAt(0).toUpperCase()+k.slice(1)}</option>)}
</select>
</div>
</div>
});

function PersonResult({r,label}){
return <div className="card">
<h3 style={{fontSize:"16px",fontWeight:"600",marginBottom:"12px"}}>{label}</h3>
<div style={{marginBottom:"12px"}}>
<div style={{display:"flex",justifyContent:"space-between",padding:"6px 0",borderBottom:"1px solid #f3f4f6"}}>
<span style={{color:"#6b7280",fontSize:"14px"}}>Gross Salary</span>
<span style={{fontWeight:"600"}}>{gbp(r.gross)}</span>
</div>
{r.pen>0&&<div style={{display:"flex",justifyContent:"space-between",padding:"6px 0",fontSize:"13px"}}>
<span style={{color:"#9ca3af"}}>Your Pension</span>
<span style={{color:"#f97316"}}>-{gbp(r.pen)}</span>
</div>}
{r.ePen>0&&<div style={{display:"flex",justifyContent:"space-between",padding:"6px 0",fontSize:"13px",background:"#f0fdf4",margin:"0 -8px",paddingLeft:"8px",paddingRight:"8px",borderRadius:"4px"}}>
<span style={{color:"#16a34a"}}>+ Employer Pension</span>
<span style={{color:"#16a34a",fontWeight:"600"}}>+{gbp(r.ePen)}</span>
</div>}
<div style={{display:"flex",justifyContent:"space-between",padding:"6px 0",fontSize:"13px"}}>
<span style={{color:"#9ca3af"}}>Income Tax</span>
<span style={{color:"#ef4444"}}>-{gbp(r.tax)}</span>
</div>
<div style={{display:"flex",justifyContent:"space-between",padding:"6px 0",fontSize:"13px"}}>
<span style={{color:"#9ca3af"}}>National Insurance</span>
<span style={{color:"#ef4444"}}>-{gbp(r.ni)}</span>
</div>
{r.sl>0&&<div style={{display:"flex",justifyContent:"space-between",padding:"6px 0",fontSize:"13px"}}>
<span style={{color:"#9ca3af"}}>Student Loan</span>
<span style={{color:"#ef4444"}}>-{gbp(r.sl)}</span>
</div>}
</div>
<div style={{padding:"14px",background:"#eef2ff",borderRadius:"8px",borderTop:"3px solid #6366f1"}}>
<div style={{display:"flex",justifyContent:"space-between",alignItems:"baseline",marginBottom:"10px"}}>
<span style={{fontWeight:"600"}}>Take-Home</span>
<span style={{fontSize:"24px",fontWeight:"700",color:"#4f46e5"}}>{gbp(r.net)}</span>
</div>
<div className="grid grid-2" style={{fontSize:"13px"}}>
<div><span style={{color:"#6b7280",fontSize:"11px"}}>Monthly</span><div style={{fontWeight:"600"}}>{gbp(r.netM)}</div></div>
<div><span style={{color:"#6b7280",fontSize:"11px"}}>Weekly</span><div style={{fontWeight:"600"}}>{gbp(r.netW)}</div></div>
</div>
</div>
</div>
}

function Dashboard({incomes}){
const totalIn=incomes.reduce((s,i)=>s+(parseFloat(i.amount)||0),0);

return <div>
<div className="grid grid-3">
<div className="stat stat-green">
<p style={{fontSize:"12px",marginBottom:"4px"}}>Monthly Income</p>
<p style={{fontSize:"22px",fontWeight:"700"}}>{gbp(totalIn)}</p>
<p style={{fontSize:"11px",opacity:0.7}}>{gbp(totalIn/52)}/wk</p>
</div>
</div>
{incomes.length===0&&<div className="card" style={{textAlign:"center",padding:"40px"}}>
<p style={{color:"#9ca3af"}}>Add income in the Pay Calculator to see your dashboard</p>
</div>}
</div>
}

ReactDOM.render(<App/>,document.getElementById("root"));
</script>
</body>
</html>
